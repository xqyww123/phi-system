<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory HOL-Library.Monad_Syntax</title>
</head>


<body>
<div class="head">
<h1>Theory HOL-Library.Monad_Syntax</h1>
</div>

<pre class="source"><span class="comment1"><span>(*  Title:      HOL/Library/Monad_Syntax.thy
    Author:     Alexander Krauss, TU Muenchen
    Author:     Christian Sternagel, University of Innsbruck
*)</span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Monad notation for arbitrary types›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="HOL-Library.Monad_Syntax.html"><span>Monad_Syntax</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="HOL-Library.Adhoc_Overloading.html"><span>Adhoc_Overloading</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹
We provide a convenient do-notation for monadic expressions well-known from Haskell.
</span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Let|const"><span>Let</span></a><span>›</span></span><span> is printed specially in do-expressions.
›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>consts</span></span></span><span>
  </span><span class="entity_def" id="Monad_Syntax.bind|const"><span>bind</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'d</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixl</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>⤜</span></span><span>"</span></span><span> 54</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>ASCII</span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>bind</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixl</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>&gt;&gt;=</span></span><span>"</span></span><span> 54</span><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span> </span><span class="main"><span>(</span></span><span>do_notation</span><span class="main"><span>)</span></span><span>
  </span><span class="entity"><span class="entity_def" id="Monad_Syntax.bind_do|const"><span>bind_do</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'b</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'c</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'d</span></span><span>"</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="free"><span>bind_do</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>bind</span></a><span>"</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>output</span></span></span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind_do|const"><span>bind_do</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixl</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>⤜</span></span><span>"</span></span><span> 54</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>notation</span></span></span><span> </span><span class="main"><span>(</span></span><span>ASCII </span><span class="keyword2"><span class="keyword"><span>output</span></span></span><span class="main"><span>)</span></span><span>
  </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind_do|const"><span>bind_do</span></a><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixl</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>&gt;&gt;=</span></span><span>"</span></span><span> 54</span><span class="main"><span>)</span></span><span>


</span><span class="keyword1"><span class="command"><span>nonterminal</span></span></span><span> </span><span class="entity_def" id="offset_699..707">do_binds</span><span> </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="offset_712..719">do_bind</span><span>
</span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span>
  </span><span class="quoted"><span>"_do_block"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_699..707"><span>do_binds</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'a</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>do</span></span><span> </span><span class="keyword1"><span>{</span></span><span class="keyword3"><span>//</span></span><span class="keyword3"><span>(2</span></span><span>  _</span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>//</span></span><span class="keyword1"><span>}</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>12</span><span class="main"><span>]</span></span><span> 62</span><span class="main"><span>)</span></span><span>
  </span><span class="quoted"><span>"_do_bind"</span></span><span>  </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_712..719"><span>do_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span>_ </span><span class="keyword1"><span>←</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> 13</span><span class="main"><span>)</span></span><span>
  </span><span class="quoted"><span>"_do_let"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_712..719"><span>do_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span class="keyword1"><span>let</span></span><span> _ </span><span class="keyword1"><span>=</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>1000</span><span class="main"><span>,</span></span><span> 13</span><span class="main"><span>]</span></span><span> 13</span><span class="main"><span>)</span></span><span>
  </span><span class="quoted"><span>"_do_then"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_712..719"><span>do_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_"</span></span><span> </span><span class="main"><span>[</span></span><span>14</span><span class="main"><span>]</span></span><span> 13</span><span class="main"><span>)</span></span><span>
  </span><span class="quoted"><span>"_do_final"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="tfree"><span>'a</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_699..707"><span>do_binds</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_"</span></span><span class="main"><span>)</span></span><span>
  </span><span class="quoted"><span>"_do_cons"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_712..719"><span>do_bind</span></a><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_699..707"><span>do_binds</span></a><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_699..707"><span>do_binds</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_</span><span class="keyword1"><span>;</span></span><span class="keyword3"><span>//</span></span><span>_"</span></span><span> </span><span class="main"><span>[</span></span><span>13</span><span class="main"><span>,</span></span><span> 12</span><span class="main"><span>]</span></span><span> 12</span><span class="main"><span>)</span></span><span>
  </span><span class="quoted"><span>"_thenM"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'c</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixl</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>⪢</span></span><span>"</span></span><span> 54</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span> </span><span class="main"><span>(</span></span><span>ASCII</span><span class="main"><span>)</span></span><span>
  </span><span class="quoted"><span>"_do_bind"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span>pttrn</span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#offset_712..719"><span>do_bind</span></a><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(2</span></span><span>_ </span><span class="keyword1"><span>&lt;-</span></span><span class="keyword3"><span>/ </span></span><span>_</span><span class="keyword3"><span>)</span></span><span>"</span></span><span> 13</span><span class="main"><span>)</span></span><span>
  </span><span class="quoted"><span>"_thenM"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><span>[</span></span><span class="tfree"><span>'a</span></span><span class="main"><span>,</span></span><span> </span><span class="tfree"><span>'b</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="tfree"><span>'c</span></span><span>"</span></span></span><span> </span><span class="main"><span>(</span></span><span class="keyword2"><span class="keyword"><span>infixl</span></span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>&gt;&gt;</span></span><span>"</span></span><span> 54</span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>translations</span></span></span><span>
  </span><span class="quoted"><span>"_do_block </span><span class="main"><span>(</span></span><span>_do_cons </span><span class="main"><span>(</span></span><span>_do_then </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_do_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
    </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind_do|const"><span>bind_do</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>_</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"_do_block </span><span class="main"><span>(</span></span><span>_do_cons </span><span class="main"><span>(</span></span><span>_do_bind </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_do_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
    </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>CONST</span></span><span> </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind_do|const"><span>bind_do</span></a><span> </span><span class="free"><span>t</span></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="free"><span>p</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"_do_block </span><span class="main"><span>(</span></span><span>_do_cons </span><span class="main"><span>(</span></span><span>_do_let </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>bs</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
    </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"</span><span class="keyword1"><span>let</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>in</span></span><span> _do_block </span><span class="free"><span>bs</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"_do_block </span><span class="main"><span>(</span></span><span>_do_cons </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span>_do_cons </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>cs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
    </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"_do_block </span><span class="main"><span>(</span></span><span>_do_cons </span><span class="free"><span>b</span></span><span> </span><span class="main"><span>(</span></span><span>_do_final </span><span class="main"><span>(</span></span><span>_do_block </span><span class="main"><span>(</span></span><span>_do_cons </span><span class="free"><span>c</span></span><span> </span><span class="free"><span>cs</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"_do_cons </span><span class="main"><span>(</span></span><span>_do_let </span><span class="free"><span>p</span></span><span> </span><span class="free"><span>t</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>(</span></span><span>_do_final </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
    </span><span class="main"><span>⇌</span></span><span> </span><span class="quoted"><span>"_do_final </span><span class="main"><span>(</span></span><span class="keyword1"><span>let</span></span><span> </span><span class="free"><span>p</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="free"><span>t</span></span><span> </span><span class="keyword1"><span>in</span></span><span> </span><span class="free"><span>s</span></span><span class="main"><span>)</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"_do_block </span><span class="main"><span>(</span></span><span>_do_final </span><span class="free"><span>e</span></span><span class="main"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>⇀</span></span><span> </span><span class="quoted"><span>"</span><span class="free"><span>e</span></span><span>"</span></span><span>
  </span><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><span>⪢</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>⇀</span></span><span> </span><span class="quoted"><span>"</span><span class="main"><span>(</span></span><span class="free"><span>m</span></span><span> </span><span class="main"><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>⤜</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span>_</span></span><span class="main"><span>.</span></span><span> </span><span class="free"><span>n</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>"</span></span><span>

</span><span class="keyword1"><span class="command"><span>adhoc_overloading</span></span></span><span>
  </span><a class="entity_ref" href="HOL-Library.Monad_Syntax.html#Monad_Syntax.bind|const"><span>bind</span></a><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.bind|const"><span>Set.bind</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Predicate.html#Predicate.bind|const"><span>Predicate.bind</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/Option.html#Option.bind|const"><span>Option.bind</span></a></span><span> </span><span class="quoted"><a class="entity_ref" href="../../HOL/HOL/List.html#List.bind|const"><span>List.bind</span></a></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
</span></pre>
</body>

</html>