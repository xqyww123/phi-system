<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Phi_BI.PhiTool_Symbol</title>
</head>


<body>
<div class="head">
<h1>Theory Phi_BI.PhiTool_Symbol</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Phi_BI.PhiTool_Symbol.html"><span>PhiTool_Symbol</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="../../HOL/HOL/Main.html"><span>Main</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Symbol Identifier unique in Isabelle Runtime and Its Persistent Image›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹When the runtime system uses N symbols in total, the length of the representation
      consumes at most 2 + log2(N) terms.
TODO: don't use nat but make a numeral so we don't need the mk_symbol wrapper›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiTool_Symbol.arity_typerep_symbol|fact"><span class="entity_def" id="PhiTool_Symbol.typerep_symbol_def|fact"><span class="entity_def" id="PhiTool_Symbol.typerep_symbol_inst.typerep_symbol|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.type_definition_symbol|fact"><span class="entity_def" id="PhiTool_Symbol.arity_type_symbol|fact"><span class="entity_def" id="PhiTool_Symbol.arity_typerep_symbol|thm"><span class="entity_def" id="PhiTool_Symbol.typerep_symbol_def|thm"><span class="entity_def" id="PhiTool_Symbol.typerep_symbol_inst.typerep_symbol|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.type_definition_symbol|thm"><span class="entity_def" id="PhiTool_Symbol.arity_type_symbol|thm"><span class="entity_def" id="PhiTool_Symbol.typerep_symbol_def_raw|axiom"><span class="entity_def" id="PhiTool_Symbol.typerep_symbol_inst.typerep_symbol_def|axiom"><span class="entity_def" id="PhiTool_Symbol.symbol.type_definition_symbol|axiom"><span class="entity_def" id="PhiTool_Symbol.arity_type_symbol|axiom"><span class="entity_def" id="PhiTool_Symbol.typerep_symbol_inst.typerep_symbol|const"><span>typedef</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="PhiTool_Symbol.symbol|type"><span>symbol</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.UNIV|const"><span>UNIV</span></a><span class="main"><span>::</span></span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.set|type"><span>set</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>morphisms</span></span></span><span> </span><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol_induct|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol_cases|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol_inject|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol_inverse|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol_induct|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol_cases|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol_inject|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol_inverse|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.Abs_symbol|const"><span>Abs_symbol</span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol_induct|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol_cases|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol_inject|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol_inverse|fact"><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol_induct|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol_cases|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol_inject|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol_inverse|thm"><span class="entity_def" id="PhiTool_Symbol.symbol.mk_symbol|const"><span>mk_symbol</span></span></span></span></span></span></span></span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.auto|method"><span class="operator"><span>auto</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>hide_const</span></span></span><span> </span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#PhiTool_Symbol.symbol.Abs_symbol|const"><span>Abs_symbol</span></a><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#PhiTool_Symbol.symbol.mk_symbol_inject|fact"><span>mk_symbol_inject</span></a><span class="main"><span>[</span></span><span class="operator"><span>simplified</span></span><span class="main"><span>,</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.iff|attribute"><span class="operator"><span>iff</span></span></a><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiTool_Symbol.mk_symbol_cong|fact"><span class="entity_def" id="PhiTool_Symbol.mk_symbol_cong|thm"><span>mk_symbol_cong</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>cong</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#PhiTool_Symbol.symbol.mk_symbol|const"><span>mk_symbol</span></a><span> </span><span class="free"><span>A</span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#PhiTool_Symbol.symbol.mk_symbol|const"><span>mk_symbol</span></a><span> </span><span class="free"><span>A</span></span><span>›</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML_file</span></span></span><span> </span><span class="quoted"><a href="USER_HOME/Current/phi-system/Phi_BI/library/syntax/PhiTool_Symbol_syntax.ML.html"><span>‹./library/syntax/PhiTool_Symbol_syntax.ML›</span></a></span><span>
</span><span class="keyword1"><span class="command"><span>ML_file</span></span></span><span> </span><span class="quoted"><a href="USER_HOME/Current/phi-system/Phi_BI/PhiTool_Symbol.ML.html"><span>‹PhiTool_Symbol.ML›</span></a></span><span>

</span><span class="keyword1"><span class="command"><span>nonterminal</span></span></span><span> </span><span class="quoted"><span>"</span><span class="entity_def" id="offset_634..643">φ_symbol_</span><span>"</span></span><span>

</span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span> </span><span class="quoted"><span>"_ID_SYMBOL_"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>id</span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#offset_634..643"><span>φ_symbol_</span></a><span>›</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"_"</span></span><span class="main"><span>)</span></span><span>
       </span><span class="quoted"><span>"_LOG_EXPR_SYMBOL_"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>logic</span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#offset_634..643"><span>φ_symbol_</span></a><span>›</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>SYMBOL'_VAR'(</span></span><span>_</span><span class="keyword1"><span>')</span></span><span>"</span></span><span class="main"><span>)</span></span><span>
       </span><span class="quoted"><span>"_MK_SYMBOL_"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#offset_634..643"><span>φ_symbol_</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#PhiTool_Symbol.symbol|type"><span>symbol</span></a><span>›</span></span></span><span> </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword1"><span>SYMBOL'(</span></span><span>_</span><span class="keyword1"><span>')</span></span><span>"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹
</span><span class="keyword1"><span class="keyword"><span>structure</span></span></span><span> </span><span class="entity"><span>Phi_Tool_Symbol</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="keyword2"><span class="keyword"><span>struct</span></span></span><span>
</span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Phi_Tool_Symbol</span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>parse</span></span><span> </span><span class="main"><span>(</span></span><span>Free</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>id</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>Phi_Tool_Symbol.mk_symbol</span></span><span> </span><span class="entity"><span>id</span></span><span>
  </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>parse</span></span><span> </span><span class="entity"><span>tm</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="entity"><span class="entity"><span class="entity"><span class="entity"><span class="entity"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>print</span></span><span class="antiquote"><span>}</span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span>tm</span></span><span class="main"><span>;</span></span><span> </span><span>error</span><span> </span><span class="inner_quoted"><span>"Expect an identifier."</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>print</span></span><span> </span><span class="entity"><span>tm</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>case</span></span></span><span> </span><span>Option.map</span><span> </span><span class="entity"><span>Phi_Tool_Symbol.revert_symbol</span></span><span> </span><span class="main"><span>(</span></span><span>try</span><span> </span><span class="entity"><span>dest_synt_numeral</span></span><span> </span><span class="entity"><span>tm</span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>of</span></span></span><span> </span><span>SOME</span><span> </span><span class="main"><span>(</span></span><span>SOME</span><span> </span><span class="entity"><span>id</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Free</span><span class="main"><span>(</span></span><span class="entity"><span>id</span></span><span class="main"><span>,</span></span><span> </span><span>dummyT</span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>|</span></span><span> </span><span>SOME</span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>error</span><span> </span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"Phi_Tool_Symbol: "</span></span><span> </span><span>^</span><span> </span><span>string_of_int</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>dest_synt_numeral</span></span><span> </span><span class="entity"><span>tm</span></span><span class="main"><span>)</span></span><span> </span><span>^</span><span> </span><span class="inner_quoted"><span>" is not a known symbol!"</span></span><span class="main"><span>)</span></span><span>
     </span><span class="main"><span>|</span></span><span> </span><span>NONE</span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>tm</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>
›</span></span><span>

</span><span class="keyword1"><span class="command"><span>parse_translation</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>[</span></span><span>
  </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_ID_SYMBOL_›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>Phi_Tool_Symbol.parse</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
  </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_LOG_EXPR_SYMBOL_›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
        </span><span>Const</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_constrain›</span></span><span class="main"><span>,</span></span><span> </span><span>dummyT</span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>x</span></span><span> </span><span>$</span><span> </span><span>Const</span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">type_syntax</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#PhiTool_Symbol.symbol|type"><span>symbol</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span>dummyT</span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
  </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_MK_SYMBOL_›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>x</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>x</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>]</span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>print_translation</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="main"><span>[</span></span><span>
  </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_syntax</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="Phi_BI.PhiTool_Symbol.html#PhiTool_Symbol.symbol.mk_symbol|const"><span>mk_symbol</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>tm</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Const</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_MK_SYMBOL_›</span></span><span class="main"><span>,</span></span><span> </span><span>dummyT</span><span class="main"><span>)</span></span><span> </span><span>$</span><span> </span><span class="entity"><span>Phi_Tool_Symbol.print</span></span><span> </span><span class="entity"><span>tm</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>]</span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="antiquoted"><span class="antiquote"><span>@{</span></span><span class="operator"><span>term</span></span><span> </span><span class="quoted"><span>‹</span><span class="keyword1"><span>SYMBOL(</span></span><span>xxx</span><span class="main"><span>)</span></span><span>›</span></span><span class="antiquote"><span>}</span></span></span><span>›</span></span><span>


</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre>
</body>

</html>