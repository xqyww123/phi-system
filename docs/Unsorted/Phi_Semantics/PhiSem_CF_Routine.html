<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory PhiSem_CF_Routine</title>
</head>


<body>
<div class="head">
<h1>Theory PhiSem_CF_Routine</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="PhiSem_CF_Routine.html"><span>PhiSem_CF_Routine</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="PhiSem_CF_Break.html"><span>PhiSem_CF_Break</span></a><span> </span><a href="PhiSem_CF_Routine_Basic.html"><span>PhiSem_CF_Routine_Basic</span></a><span> </span><a href="PhiSem_Void.html"><span>PhiSem_Void</span></a><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Based on the basic routine module, we provide the version that supports return statement.›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Core.html#IDE_CP_Core.\&lt;phi&gt;hide_techinicals|attribute"><span class="operator"><span>φhide_techinicals</span></span></a><span> </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><span class="quasi_keyword"><span>false</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_def|fact"><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_def|thm"><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME|const"><span>RETURN_FRAME</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="tfree"><span>'rets</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.FIX_ARITY_VALs|class"><span>FIX_ARITY_VALs</span></a><span> </span><span>itself</span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.RES.brk_label|type"><span>RES.brk_label</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><span class="main"><span>(</span></span><span class="tfree"><span>'rets</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.\&lt;phi&gt;arg|type"><span>φarg</span></a><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.fiction|type"><span>fiction</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_BI.Phi_BI.html#Phi_BI.BI|type"><span>BI</span></a><span class="main"><span>)</span></span><span> </span><span class="main"><span>⇒</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>RETURN_FRAME</span></span><span> </span><span class="main"><span class="bound"><span class="entity"><span>_</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>label</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>Y</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>⟷</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.True|const"><span>True</span></a><span>›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_I|fact"><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_I|thm"><span>RETURN_FRAME_I</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME|const"><span>RETURN_FRAME</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>label</span></span><span> </span><span class="free"><span>Y</span></span><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME_def|fact"><span>RETURN_FRAME_def</span></a><span> </span><span class="keyword1"><span class="command"><span>..</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_normal|fact"><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_normal|thm"><span>RETURN_FRAME_normal</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME|const"><span>RETURN_FRAME</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'rets</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>label</span></span><span> </span><span class="free"><span>Y</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.op_break|const"><span>op_break</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'any</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'rets</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>label</span></span><span> </span><span class="free"><span>ret</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⦃</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/IDE_CP_Core.html#IDE_CP_Core.Technical|const"><span>TECHNICAL</span></a></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.Brk_Frame|const"><span>Brk_Frame</span></a><span> </span><span class="free"><span>label</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>ret</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⟼</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⦄</span></a></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>𝗍𝗁𝗋𝗈𝗐𝗌</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.Brking_Frame|const"><span>Brking_Frame</span></a><span> </span><span class="free"><span>label</span></span><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> ›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="free"><span>ret</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="tfree"><span>'rets</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.FIX_ARITY_VALs|class"><span>FIX_ARITY_VALs</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.\&lt;phi&gt;arg|type"><span>φarg</span></a><span>›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.op_break_\&lt;phi&gt;app|fact"><span>op_break_φapp</span></a><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_unit|fact"><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME_unit|thm"><span>RETURN_FRAME_unit</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹ </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME|const"><span>RETURN_FRAME</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>label</span></span><span> </span><span class="free"><span>Y</span></span><span>
</span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.op_break|const"><span>op_break</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'any</span></span><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.unit|type"><span>unit</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span>label</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.\&lt;phi&gt;arg.\&lt;phi&gt;arg|const"><span>φarg</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⦃</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/IDE_CP_Core.html#IDE_CP_Core.Technical|const"><span>TECHNICAL</span></a></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.Brk_Frame|const"><span>Brk_Frame</span></a><span> </span><span class="free"><span>label</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.\&lt;phi&gt;arg.\&lt;phi&gt;arg|const"><span>φarg</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Product_Type.html#Product_Type.Unity|const"><span>()</span></a></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⟼</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⦄</span></a></span><span>
    </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>𝗍𝗁𝗋𝗈𝗐𝗌</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="main"><span class="bound"><span>_</span></span></span><span class="main"><span>.</span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.Brking_Frame|const"><span>Brking_Frame</span></a><span> </span><span class="free"><span>label</span></span><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span> ›</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.op_break_\&lt;phi&gt;app|fact"><span>op_break_φapp</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics_Framework/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> S</span><span class="main"><span class="main"><span>=</span></span></span><span class="quoted"><span class="free"><span>Y</span></span></span><span class="main"><span>]</span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="comment1"><span>(* TODO: suppress the Frame tailing in the above rules!!!!
lemma RETURN_FRAME_normal:
  ‹ RETURN_FRAME TYPE('rets) label Y
⟹ State 𝗍𝗋𝖺𝗇𝗌𝖿𝗈𝗋𝗆𝗌 Y ret❟ TECHNICAL Brk_Frame label
⟹ 𝗉𝗋𝗈𝖼 (op_break TYPE('any) TYPE('rets) label ret) ⦃ State ⟼ 0 ⦄
    𝗍𝗁𝗋𝗈𝗐𝗌 (λ_. Brking_Frame label Y) ›
  for ret :: ‹'rets::FIX_ARITY_VALs φarg›
❴ premises _ and Tr 
  Tr
  op_break_φapp
❵ .

term ‹Identity_Elements›

lemma RETURN_FRAME_unit:
  ‹ RETURN_FRAME TYPE(unit) label Y
⟹ State 𝗍𝗋𝖺𝗇𝗌𝖿𝗈𝗋𝗆𝗌 Y (φarg ())❟ TECHNICAL Brk_Frame label
⟹ 𝗉𝗋𝗈𝖼 (op_break TYPE('any) TYPE(unit) label (φarg ())) ⦃ State ⟼ 0 ⦄
    𝗍𝗁𝗋𝗈𝗐𝗌 (λ_. Brking_Frame label Y) ›
❴ premises _ and Tr
  Tr
  apply_rule op_break_φapp[where S=Y]
❵ .
*)</span></span><span>

</span><span class="keyword1"><span class="command"><span>attribute_setup</span></span></span><span> </span><span class="entity_def" id="PhiSem_CF_Routine.RETURN_FRAME|attribute"><span>RETURN_FRAME</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="quoted"><span>‹</span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span>Thm.rule_attribute</span><span> </span><span class="main"><span>[</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>th</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
                    </span><span class="entity"><span>th</span></span><span> </span><span>RS</span><span> </span><span class="main"><span>(</span></span><span>Thm.transfer''</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm'</span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME_unit|fact"><span>RETURN_FRAME_unit</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span>
    </span><span class="keyword3"><span class="keyword"><span>handle</span></span></span><span> </span><span>THM</span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="entity"><span>th</span></span><span> </span><span>RS</span><span> </span><span class="main"><span>(</span></span><span>Thm.transfer''</span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm'</span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME_normal|fact"><span>RETURN_FRAME_normal</span></a><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>)</span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>declare</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>[</span></span><span>
  </span><a class="entity_ref" href="../Phi_Semantics_Framework/USER_HOME/Current/phi-system/Phi_BI/library/system/premise_attribute.ML.html#Phi_Preliminary.\&lt;phi&gt;premise_attribute|attribute"><span class="operator"><span>φpremise_attribute</span></span></a><span> </span><span class="main"><span class="main"><span>[</span></span></span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME|attribute"><span class="operator"><span>RETURN_FRAME</span></span></a><span class="main"><span class="main"><span>]</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span class="quasi_keyword"><span>for</span></span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME|const"><span>RETURN_FRAME</span></a><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>_</span></span><span>›</span></span></span><span>  </span><span class="main"><span class="main"><span>(</span></span></span><span class="main"><span class="main"><span>%</span></span></span><span>φattr</span><span class="main"><span class="main"><span>)</span></span></span><span>
</span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span>

</span><span class="comment1"><span>(* RETURN_FRAME TYPE('rets::FIX_ARITY_VALs) label_ret *)</span></span><span>

</span><span class="keyword1"><span class="command"><span>proc</span></span></span><span> </span><span class="entity_def" id="PhiSem_CF_Routine.op_routine_\&lt;phi&gt;app|fact"><span class="entity_def" id="PhiSem_CF_Routine.op_routine_def|fact"><span class="entity_def" id="PhiSem_CF_Routine.op_routine_\&lt;phi&gt;app|thm"><span class="entity_def" id="PhiSem_CF_Routine.op_routine_def|thm"><span class="entity_def" id="PhiSem_CF_Routine.op_routine_def|axiom"><span class="entity_def" id="PhiSem_CF_Routine.op_routine|const"><span>op_routine</span></span></span></span></span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>requires</span></span></span><span> </span><span class="entity_def" id="offset_2081..2085">Ty_X</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Semantic_Types|const"><span>Semantic_Types</span></a><span> </span><span class="free"><span>X</span></span><span> </span><span class="free"><span>TY_ARGs</span></span><span>›</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>  </span><span class="entity_def" id="offset_2125..2129">Ty_Y</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.Semantic_Types|const"><span>Semantic_Types</span></a><span> </span><span class="free"><span>Y</span></span><span> </span><span class="free"><span>TY_RETs</span></span><span>›</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.\&lt;r&gt;Success|const"><span>𝗋Success</span></a><span>›</span></span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span>  </span><span class="entity_def" id="offset_2191..2192">F</span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="main"><span>(</span></span><span class="main"><span>⋀</span></span><span class="main"><span>(</span></span><span class="bound"><span>vs</span></span><span class="main"><span>::</span></span><span> </span><span class="tfree"><span>'args</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.FIX_ARITY_VALs|class"><span>FIX_ARITY_VALs</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.\&lt;phi&gt;arg|type"><span>φarg</span></a><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning1.html#IDE_CP_Reasoning1.named|type"><span>&lt;named&gt;</span></a></span><span> </span><span class="tfree"><span>'names</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>label_ret</span></span><span class="main"><span>.</span></span><span>
            </span><span class="bound"><span>return_φapp</span></span><span class="main"><span><span class="hidden">❙</span><b>:</b></span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/IDE_CP_Core.html#IDE_CP_Core.Technical|const"><span>TECHNICAL</span></a></span><span class="main"><span>(</span></span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME|const"><span>RETURN_FRAME</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'rets</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.FIX_ARITY_VALs|class"><span>FIX_ARITY_VALs</span></a><span class="main"><span>)</span></span><span> </span><span class="bound"><span>label_ret</span></span><span> </span><span class="free"><span>Y</span></span><span class="main"><span>)</span></span><span>
            </span><span class="main"><span>⟹</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>𝗉𝗋𝗈𝖼</span></a></span><span> </span><span class="free"><span>F</span></span><span> </span><span class="bound"><span>label_ret</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning1.html#IDE_CP_Reasoning1.named.case_named|const"><span>case_named</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>x</span></span><span class="main"><span>.</span></span><span> </span><span class="bound"><span>x</span></span><span class="main"><span>)</span></span><span> </span><span class="bound"><span>vs</span></span><span class="main"><span>)</span></span><span>
                   </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⦃</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/IDE_CP_Core.html#IDE_CP_Core.Technical|const"><span>TECHNICAL</span></a></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.Brk_Frame|const"><span>Brk_Frame</span></a><span> </span><span class="bound"><span>label_ret</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>X</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning1.html#IDE_CP_Reasoning1.named.case_named|const"><span>case_named</span></a><span> </span><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.id|const"><span>id</span></a><span> </span><span class="bound"><span>vs</span></span><span class="main"><span>)</span></span><span>
                 </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⟼</span></a></span><span> </span><span class="main"><span>λ</span></span><span class="bound"><span>ret</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/IDE_CP_Core.html#IDE_CP_Core.Technical|const"><span>TECHNICAL</span></a></span><span> </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.Brk_Frame|const"><span>Brk_Frame</span></a><span> </span><span class="bound"><span>label_ret</span></span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.COMMA|const"><span>❟</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="bound"><span>ret</span></span><span>
                   </span><span class="main"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>⦄</span></a></span><span> </span><span class="keyword1"><a class="entity_ref" href="../Phi_System/Spec_Framework.html#Spec_Framework.\&lt;phi&gt;Procedure|const"><span>𝗍𝗁𝗋𝗈𝗐𝗌</span></a></span><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>e</span></span><span class="main"><span>.</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.sift_brking_frame|const"><span>𝖻𝗋𝖾𝖺𝗄</span></a></span><span> </span><span class="bound"><span>label_ret</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.sift_brking_frame|const"><span>𝗐𝗂𝗍𝗁</span></a></span><span> </span><span class="free"><span>Y</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.sift_brking_frame|const"><span>𝗈𝗋</span></a></span><span> </span><span class="free"><span>E</span></span><span> </span><span class="bound"><span>e</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>input</span></span></span><span>  </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>X</span></span><span> </span><span class="free"><span>vs</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>output</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>Y</span></span><span>›</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>throws</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span>E</span></span><span>›</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>apply_rule</span></span></span><span> </span><span class="quoted"><span>"</span><a class="entity_ref" href="PhiSem_CF_Routine_Basic.html#PhiSem_CF_Routine_Basic.__routine_basic__|fact"><span>__routine_basic__</span></a><span>"</span></span><span class="main"><span>[</span></span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#offset_2081..2085"><span>Ty_X</span></a><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#offset_2125..2129"><span>Ty_Y</span></a><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Logic_Programming_Reasoner.PLPR.html#PLPR.\&lt;r&gt;Success_I|fact"><span>𝗋Success_I</span></a><span class="main"><span>,</span></span><span> </span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics_Framework/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> </span><span class="tfree"><span>'names</span></span><span class="main"><span class="main"><span>=</span></span></span><span class="tfree"><span class="quoted"><span class="tfree"><span>'names</span></span></span></span><span class="main"><span>,</span></span><span>
                                 </span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning1.html#IDE_CP_Reasoning1.named_All|fact"><span>named_All</span></a><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span> </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>vs</span></span><span> 
    </span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.op_brk_scope_\&lt;phi&gt;app|fact"><span>op_brk_scope</span></a><span> </span><span class="keyword1"><span class="command"><span>❴</span></span></span><span>  </span><span class="keyword2"><span class="keyword"><span>for</span></span></span><span> </span><span class="skolem"><span>label_ret</span></span><span>
      </span><span class="keyword2"><span class="keyword"><span>apply_rule</span></span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#offset_2191..2192"><span>F</span></a><span class="main"><span>[</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.of|attribute"><span class="operator"><span>of</span></span></a><span> </span><span class="quoted"><span class="skolem"><span>label_ret</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../Phi_System/IDE_CP_Reasoning1.html#IDE_CP_Reasoning1.named.tag|const"><span>tag</span></a><span> </span><span class="skolem"><span>vs</span></span><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../Phi_System/IDE_CP_Core.html#IDE_CP_Core.Technical_def|fact"><span>Technical_def</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics_Framework/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> </span><span class="tfree"><span>'a</span></span><span class="main"><span class="main"><span class="main"><span>=</span></span></span></span><span class="quoted"><span class="quoted"><span>‹</span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>›</span></span></span><span class="main"><span class="main"><span>]</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>OF</span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME_I|fact"><span>RETURN_FRAME_I</span></a><span class="main"><span>]</span></span><span>
    </span><span class="keyword1"><span class="command"><span>❵</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>❵</span></span></span><span>
</span><span class="keyword1"><span class="command"><span>❵</span></span></span><span> </span><span class="keyword1"><span class="command"><span>.</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>ML</span></span></span><span> </span><span class="quoted"><span>‹</span><span>Synchronized.change</span><span> </span><span class="entity"><span>Phi_Syntax.semantic_oprs</span></span><span> </span><span class="main"><span>(</span></span><span>Symtab.update</span><span> </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_name</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.op_routine|const"><span>op_routine</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="inner_numeral"><span>0</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span><span>


</span><span class="keyword1"><span class="command"><span>abbreviation</span></span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‹</span><span class="free"><span class="entity_def" id="PhiSem_CF_Routine.op_rec_routine|const"><span>op_rec_routine</span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>argtys</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>rettys</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>F</span></span></span></span><span> </span><span class="main"><span>≡</span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Basic.html#PhiSem_CF_Basic.op_fix_point|const"><span>op_fix_point</span></a><span> </span><span class="main"><span>(</span></span><span class="main"><span>λ</span></span><span class="bound"><span>𝖿</span></span><span class="main"><span>.</span></span><span>
        </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.op_routine|const"><span>op_routine</span></a><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'ret</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.FIX_ARITY_VALs|class"><span>FIX_ARITY_VALs</span></a><span class="main"><span>)</span></span><span> </span><span class="keyword1"><span>TYPE</span></span><span class="main"><span>(</span></span><span class="tfree"><span>'arg</span></span><span class="main"><span>::</span></span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.FIX_ARITY_VALs|class"><span>FIX_ARITY_VALs</span></a><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>argtys</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>rettys</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>F</span></span></span></span><span> </span><span class="bound"><span>𝖿</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span></span><span>


</span><span class="keyword1"><span class="command"><span>attribute_setup</span></span></span><span> </span><span class="entity_def" id="PhiSem_CF_Routine.routine|attribute"><span>routine</span></span><span> </span><span class="main"><span>=</span></span><span>
  </span><span class="quoted"><span>‹</span><span>Scan.succeed</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Phi_Modifier.wrap_to_attribute</span></span><span>
      </span><span class="main"><span>(</span></span><span class="entity"><span>PhiSem_Control_Flow.routine_mod</span></span><span>
          </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>T</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">typ</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.RES.brk_label|type"><span>RES.brk_label</span></a><span>›</span></span></span><span> </span><span>--&gt;</span><span> </span><span class="entity"><span>T</span></span><span class="main"><span>)</span></span><span>
          </span><span class="main"><span>(</span></span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>N</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>wrap</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>Tm</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span>Abs</span><span class="main"><span>(</span></span><span class="inner_quoted"><span>"label_ret"</span></span><span class="main"><span>,</span></span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">typ</span><span class="hidden">&gt;</span></span></span><span class="quoted"><span>‹</span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.RES.brk_label|type"><span>RES.brk_label</span></a><span>›</span></span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>wrap</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>Tm</span></span><span> </span><span>$</span><span> </span><span>Bound</span><span> </span><span class="entity"><span>N</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>
          </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>thm</span></span><span> "</span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.op_routine_\&lt;phi&gt;app|fact"><span>op_routine_φapp</span></a><span>"</span><span class="antiquote"><span>}</span></span></span></span><span class="main"><span>)</span></span><span class="main"><span>)</span></span><span>›</span></span><span>

</span><span class="keyword1"><span class="command"><span>hide_fact</span></span></span><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME_normal|fact"><span>RETURN_FRAME_normal</span></a><span> </span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.RETURN_FRAME_unit|fact"><span>RETURN_FRAME_unit</span></a><span>


</span><span class="keyword1"><span class="command"><span>subsection</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‹Syntax›</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>syntax</span></span></span><span> </span><span class="quoted"><span>"_routine_"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>idt</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>logic</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>logic</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>do_binds</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>do_bind</span><span>›</span></span></span><span>
          </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(</span></span><span class="keyword3"><span>(2</span></span><span class="keyword1"><span>𝗋𝗈𝗎𝗍𝗂𝗇𝖾</span></span><span> </span><span class="keyword1"><span>'(</span></span><span>_ </span><span class="keyword1"><span>:</span></span><span> _</span><span class="keyword1"><span>')</span></span><span> </span><span class="keyword1"><span>:</span></span><span> _ </span><span class="keyword1"><span>{</span></span><span class="keyword3"><span>//</span></span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>(</span></span><span>_</span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>//</span></span><span class="keyword1"><span>}</span></span><span class="keyword3"><span>)</span></span><span>"</span></span><span> </span><span class="main"><span>[</span></span><span>12</span><span class="main"><span>,</span></span><span>12</span><span class="main"><span>,</span></span><span>100</span><span class="main"><span>,</span></span><span>12</span><span class="main"><span>]</span></span><span> 13</span><span class="main"><span>)</span></span><span>
       </span><span class="quoted"><span>"_recursive_routine_"</span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‹</span><span>idt</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>idt</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>logic</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>logic</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>do_binds</span><span> </span><span class="main"><span>⇒</span></span><span> </span><span>do_bind</span><span>›</span></span></span><span>
          </span><span class="main"><span>(</span></span><span class="quoted"><span>"</span><span class="keyword3"><span>(</span></span><span class="keyword3"><span>(2</span></span><span class="keyword1"><span>𝗋𝖾𝖼𝗎𝗋𝗌𝗂𝗏𝖾-𝗋𝗈𝗎𝗍𝗂𝗇𝖾</span></span><span> _ </span><span class="keyword1"><span>'(</span></span><span>_ </span><span class="keyword1"><span>:</span></span><span> _</span><span class="keyword1"><span>')</span></span><span> </span><span class="keyword1"><span>:</span></span><span> _ </span><span class="keyword1"><span>{</span></span><span class="keyword3"><span>//</span></span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>(</span></span><span>_</span><span class="keyword3"><span>)</span></span><span class="keyword3"><span>//</span></span><span class="keyword1"><span>}</span></span><span class="keyword3"><span>)</span></span><span>"</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>print_ast_translation</span></span></span><span> </span><span class="quoted"><span>‹</span><span class="keyword2"><span class="keyword"><span>let</span></span></span><span> </span><span class="keyword3"><span class="keyword"><span>open</span></span></span><span> </span><span>Ast</span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>get_label</span></span><span> </span><span class="main"><span>(</span></span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_constrain"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>BV</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>get_label</span></span><span> </span><span class="entity"><span>BV</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>get_label</span></span><span> </span><span class="main"><span>(</span></span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_bound"</span></span><span class="main"><span>,</span></span><span> </span><span>Variable</span><span> </span><span class="entity"><span>bv</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>bv</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>is_label</span></span><span> </span><span class="entity"><span>lb</span></span><span> </span><span class="main"><span>(</span></span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_constrain"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>BV</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>is_label</span></span><span> </span><span class="entity"><span>lb</span></span><span> </span><span class="entity"><span>BV</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>is_label</span></span><span> </span><span class="entity"><span>lb</span></span><span> </span><span class="main"><span>(</span></span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_bound"</span></span><span class="main"><span>,</span></span><span> </span><span>Variable</span><span> </span><span class="entity"><span>bv</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>bv</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>lb</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>tr</span></span><span> </span><span class="entity"><span>lret</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tm</span></span><span> </span><span class="keyword1"><span class="keyword"><span>as</span></span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_syntax</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="PhiSem_CF_Break.html#PhiSem_CF_Break.op_break|const"><span>PhiSem_CF_Break.op_break</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>BV</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>is_label</span></span><span> </span><span class="entity"><span>lret</span></span><span> </span><span class="entity"><span>BV</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_syntax</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Return|const"><span>Return</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span>
        </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="entity"><span>tm</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>tr</span></span><span> </span><span class="entity"><span>lret</span></span><span> </span><span class="main"><span>(</span></span><span>Appl</span><span> </span><span class="entity"><span>aps</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>(</span></span><span>map</span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>tr</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>aps</span></span><span class="main"><span>)</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>tr</span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="entity"><span>X</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>X</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>tr0</span></span><span> </span><span class="entity"><span>cfg</span></span><span> </span><span class="main"><span>(</span></span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_do_block›</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>tr</span></span><span> </span><span class="entity"><span>cfg</span></span><span> </span><span class="entity"><span>X</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>tr0</span></span><span> </span><span class="entity"><span>cfg</span></span><span> </span><span class="entity"><span>X</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>tr</span></span><span> </span><span class="entity"><span>cfg</span></span><span> </span><span class="entity"><span>X</span></span><span>
  </span><span class="keyword1"><span class="keyword"><span>fun</span></span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="main"><span>(</span></span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_list›</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>X</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="main"><span>(</span></span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_args"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>A</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>B</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"<span class="hidden">\&lt;^</span><span class="control">const</span><span class="hidden">&gt;</span>Product_Type.Times"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>A</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>B</span></span><span class="main"><span>]</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="main"><span>(</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_syntax</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>Nil</span></a><span>›</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>=</span></span><span>
        </span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_syntax</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="PhiSem_Void.html#PhiSem_Void.\&lt;v&gt;\&lt;o&gt;\&lt;i&gt;\&lt;d&gt;|const"><span>𝗏𝗈𝗂𝖽</span></a><span>›</span></span><span>
    </span><span class="main"><span>|</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>X</span></span><span> </span><span class="main"><span>=</span></span><span> </span><span class="entity"><span>X</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>in</span></span></span><span> </span><span class="main"><span>[</span></span><span>
  </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_syntax</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.op_routine|const"><span>op_routine</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>Syntax_Group.is_enabled</span></span><span> </span><span class="main"><span>(</span></span><span>Proof_Context.theory_of</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>syntax_group</span></span><span> </span><span>do_notation</span><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>TY1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>TY2</span></span><span class="main"><span>,</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>,</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>arg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_routine_›</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>arg</span></span><span class="main"><span>,</span></span><span>
                </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>TY1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>TY2</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>tr0</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>get_label</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span>
       </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>[</span></span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="main"><span>_</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>TY1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>TY2</span></span><span class="main"><span>,</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>,</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>arg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Y</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>
            </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_routine_›</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>arg</span></span><span class="main"><span>,</span></span><span>
                  </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>TY1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>TY2</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>tr0</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>get_label</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span>
            </span><span class="entity"><span>Y</span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword3"><span class="keyword"><span>raise</span></span></span><span> </span><span>Match</span><span class="main"><span>)</span></span><span class="main"><span>,</span></span><span>
  </span><span class="main"><span>(</span></span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">const_syntax</span><span class="hidden">&gt;</span></span></span><span>‹</span><a class="entity_ref" href="PhiSem_CF_Routine.html#PhiSem_CF_Routine.op_rec_routine|const"><span>op_rec_routine</span></a><span>›</span></span><span class="main"><span>,</span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="entity"><span>ctxt</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>if</span></span></span><span> </span><span class="entity"><span>Syntax_Group.is_enabled</span></span><span> </span><span class="main"><span>(</span></span><span>Proof_Context.theory_of</span><span> </span><span class="entity"><span>ctxt</span></span><span class="main"><span>)</span></span><span> </span><span class="antiquoted"><span class="entity"><span class="antiquote"><span>@{</span></span><span class="operator"><span>syntax_group</span></span><span> </span><span>do_notation</span><span class="antiquote"><span>}</span></span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>then</span></span></span><span>
      </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>TY1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>TY2</span></span><span class="main"><span>,</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lf</span></span><span class="main"><span>,</span></span><span>
                              </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>,</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>arg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_recursive_routine_›</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>arg</span></span><span class="main"><span>,</span></span><span>
                </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>TY1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>TY2</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>tr0</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>get_label</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span>
       </span><span class="main"><span>|</span></span><span> </span><span class="main"><span>[</span></span><span class="entity"><span>TY1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>TY2</span></span><span class="main"><span>,</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lf</span></span><span class="main"><span>,</span></span><span> 
                              </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>,</span></span><span> </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="inner_quoted"><span>"_abs"</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>arg</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>Y</span></span><span class="main"><span>]</span></span><span class="main"><span>]</span></span><span> </span><span class="main"><span>=&gt;</span></span><span>
          </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>
            </span><span>Appl</span><span> </span><span class="main"><span>[</span></span><span>Constant</span><span> </span><span class="antiquoted"><span class="operator"><span><span class="hidden">\&lt;^</span><span class="control">syntax_const</span><span class="hidden">&gt;</span></span></span><span>‹_routine_›</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>lf</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>arg</span></span><span class="main"><span>,</span></span><span>
                  </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>TY1</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>strip_list</span></span><span> </span><span class="entity"><span>TY2</span></span><span class="main"><span>,</span></span><span> </span><span class="entity"><span>tr0</span></span><span> </span><span class="main"><span>(</span></span><span class="entity"><span>get_label</span></span><span> </span><span class="entity"><span>lret</span></span><span class="main"><span>)</span></span><span> </span><span class="entity"><span>X</span></span><span class="main"><span>]</span></span><span class="main"><span>,</span></span><span>
            </span><span class="entity"><span>Y</span></span><span class="main"><span>]</span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>else</span></span></span><span> </span><span class="keyword1"><span class="keyword"><span>fn</span></span></span><span> </span><span class="main"><span>_</span></span><span> </span><span class="main"><span>=&gt;</span></span><span> </span><span class="keyword3"><span class="keyword"><span>raise</span></span></span><span> </span><span>Match</span><span class="main"><span>)</span></span><span>
</span><span class="main"><span>]</span></span><span> </span><span class="keyword2"><span class="keyword"><span>end</span></span></span><span>›</span></span><span>




</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre>
</body>

</html>