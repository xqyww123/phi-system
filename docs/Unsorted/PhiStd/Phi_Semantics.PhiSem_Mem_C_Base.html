<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><link rel="stylesheet" type="text/css" href="isabelle.css"/>
<title>Theory Phi_Semantics.PhiSem_Mem_C_Base</title>
</head>


<body>
<div class="head">
<h1>Theory Phi_Semantics.PhiSem_Mem_C_Base</h1>
</div>

<pre class="source"><span class="keyword1"><span class="command"><span>chapter</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‚ÄπBasis of C Memory Semantics and Fictions‚Ä∫</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>theory</span></span></span><span> </span><a href="Phi_Semantics.PhiSem_Mem_C_Base.html"><span>PhiSem_Mem_C_Base</span></a><span>
  </span><span class="keyword2"><span class="keyword"><span>imports</span></span></span><span> </span><a href="Phi_Semantics.PhSem_MoV.html"><span>PhSem_MoV</span></a><span> </span><a href="../Phi_Semantics/PhiSem_Void.html"><span>PhiSem_Void</span></a><span> </span><span class="quoted"><span>"</span><a href="../Phi_Semantics/HOL-Library.Word.html"><span>HOL-Library.Word</span></a><span>"</span></span><span>
</span><span class="keyword2"><span class="keyword"><span>begin</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‚ÄπSemantics‚Ä∫</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>debt_axiomatization</span></span></span><span>
        </span><span class="free"><span class="entity_def" id="PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></span></span><span>     </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>‚áí</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>‚Ä∫</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="free"><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset|const"><span>idx_step_offset</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>‚áí</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Element_Path.html#Phi_Element_Path.aggregate_index|type"><span>aggregate_index</span></a><span> </span><span class="main"><span>‚áí</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.memobj_size_step|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.memobj_size_step|thm"><span>memobj_size_step</span></span></span><span> </span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>‚üπ</span></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>‚â§</span></a></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="free"><span>T</span></span><span>‚Ä∫</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset_size|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset_size|thm"><span>idx_step_offset_size</span></span></span><span class="main"><span>:</span></span><span>
          </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>‚üπ</span></span><span> </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>‚â§</span></a></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="free"><span>T</span></span><span>‚Ä∫</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset_no_overlap|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.idx_step_offset_no_overlap|thm"><span>idx_step_offset_no_overlap</span></span></span><span class="main"><span>:</span></span><span>
          </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><span>‚üπ</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><span>‚üπ</span></span><span>
                </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>‚â§</span></a></span><span> </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><span>‚üπ</span></span><span>
                </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>j</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><span class="free"><span>idx_step_offset</span></span><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>‚üπ</span></span><span>
                </span><span class="free"><span>i</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>j</span></span><span>‚Ä∫</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.memobj_size_void|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.memobj_size_void|thm"><span>memobj_size_void</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><span class="free"><span>MemObj_Size</span></span><span> </span><a class="entity_ref" href="../Phi_Semantics/PhiSem_Void.html#PhiSem_Void.\&lt;v&gt;\&lt;o&gt;\&lt;i&gt;\&lt;d&gt;|const"><span>ùóèùóàùóÇùñΩ</span></a><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>‚Ä∫</span></span></span><span>
    </span><span class="keyword2"><span class="keyword"><span>and</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_value_uniq|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_value_uniq|thm"><span>phantom_mem_value_uniq</span></span></span><span class="main"><span>:</span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><span class="free"><span>MemObj_Size</span></span><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span> </span><span class="main"><span>‚üπ</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>‚àà</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>‚üπ</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>‚àà</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="main"><span>‚üπ</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>v</span></span><span>‚Ä∫</span></span></span><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset.simps|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_def|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset.simps(2)|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset.simps(1)|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_def|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_def|axiom"><span>primrec</span></span></span></span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>‚áí</span></span><span> </span><a class="entity_ref" href="../Phi_System/Phi_Element_Path.html#Phi_Element_Path.aggregate_path|type"><span>aggregate_path</span></a><span> </span><span class="main"><span>‚áí</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Nat.html#Nat.nat|type"><span>nat</span></a><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><span class="free"><span>index_offset</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>T</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>[]</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>‚Ä∫</span></span></span><span>
      </span><span class="main"><span>|</span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><span class="free"><span>index_offset</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>T</span></span></span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Cons|const"><span>#</span></a></span><span class="free"><span class="bound"><span class="entity"><span>idx</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset|const"><span>idx_step_offset</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>T</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><span class="free"><span>index_offset</span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>i</span></span></span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>T</span></span></span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>idx</span></span></span></span><span>‚Ä∫</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_tail|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_tail|thm"><span>index_offset_tail</span></span></span><span class="main"><span>[</span></span><span class="operator"><span>simp</span></span><span class="main"><span>]</span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>idx</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="main"><span>[</span></span><span class="free"><span>i</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>idx</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset|const"><span>idx_step_offset</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>idx</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>i</span></span><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>T</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.fold_tail|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.fold_tail|thm"><span>fold_tail</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../../HOL/HOL/List.html#List.fold|const"><span>fold</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>l</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span> </span><span class="main"><span>[</span></span><span class="free"><span>x</span></span><span class="main"><span>]</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>x</span></span><span> </span><span class="keyword1"><a class="entity_ref" href="../../HOL/HOL/Fun.html#Fun.comp|const"><span>o</span></a></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.fold|const"><span>fold</span></a><span> </span><span class="free"><span>f</span></span><span> </span><span class="free"><span>l</span></span><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>l</span></span></span><span class="main"><span class="keyword3"><span>;</span></span></span><span> </span><span class="operator"><span>simp</span></span><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_upper_bound|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_upper_bound|thm"><span>index_offset_upper_bound</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>‚üπ</span></span><span>
   </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.index_type|const"><span>index_type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>‚â§</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>base</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>base</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.rev_induct|fact"><span>rev_induct</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fold_tail|fact"><span>fold_tail</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>insert</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset_size|fact"><span>idx_step_offset_size</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemmas</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_upper_bound_0|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_upper_bound_0|thm"><span>index_offset_upper_bound_0</span></span></span><span> </span><span class="main"><span>=</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset_upper_bound|fact"><span>index_offset_upper_bound</span></a><span class="main"><span>[</span></span><span class="keyword2"><span class="keyword"><a class="entity_ref" href="../Phi_Semantics_Framework/ISABELLE_HOME/src/HOL/Eisbach/eisbach_rule_insts.ML.html#Eisbach.where|attribute"><span class="operator"><span>where</span></span></a></span></span><span> base </span><span class="main"><span class="main"><span>=</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>"</span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.list.Nil|const"><span>[]</span></a></span><span>"</span></span></span><span class="main"><span>,</span></span><span> </span><span class="operator"><span>simplified</span></span><span class="main"><span>]</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_bound|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_bound|thm"><span>index_offset_bound</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>‚üπ</span></span><span>
  </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>‚â§</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>‚àß</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>‚â§</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>base</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span class="improper"><span class="command"><span>apply</span></span></span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>base</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.rev_induct|fact"><span>rev_induct</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
         </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fold_tail|fact"><span>fold_tail</span></a><span class="main"><span>)</span></span><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset_size|fact"><span>idx_step_offset_size</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset_upper_bound|fact"><span>index_offset_upper_bound</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>

</span><span class="keyword1"><span class="command"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|thm"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_def_raw|axiom"><span>definition</span></span></span></span></span></span><span> </span><span class="entity"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></span></span><span> </span><span class="main"><span>::</span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.TY|type"><span>TY</span></a><span> </span><span class="main"><span>‚áí</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.bool|type"><span>bool</span></a><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword2"><span class="keyword"><span>where</span></span></span><span> </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><span class="free"><span>phantom_mem_semantic_type</span></span><span> </span><span class="free"><span class="bound"><span class="entity"><span>TY</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.iff|const"><span>‚ü∑</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="free"><span class="bound"><span class="entity"><span>TY</span></span></span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.zero_class.zero|const"><span>0</span></a></span><span>‚Ä∫</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_single_value|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_single_value|thm"><span>phantom_mem_semantic_type_single_value</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‚Äπ </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>‚üπ</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>‚àà</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>‚üπ</span></span><span> </span><span class="free"><span>v</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.member|const"><span>‚àà</span></a></span><span> </span><a class="entity_ref" href="../Phi_Semantics_Framework/Phi_Semantics_Framework.html#Phi_Semantics_Framework.Well_Type|const"><span>Well_Type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>‚üπ</span></span><span> </span><span class="free"><span>u</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.eq|const"><span>=</span></a></span><span> </span><span class="free"><span>v</span></span><span> ‚Ä∫</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|fact"><span>phantom_mem_semantic_type_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_value_uniq|fact"><span>phantom_mem_value_uniq</span></a><span class="main"><span>[</span></span><span class="operator"><span>unfolded</span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/Set.html#Set.is_singleton_def|fact"><span>is_singleton_def</span></a><span class="main"><span>]</span></span><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/HOL/Tools/Metis/metis_tactic.ML.html#Metis.metis|method"><span class="operator"><span>metis</span></span></a><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_bound_strict|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.index_offset_bound_strict|thm"><span>index_offset_bound_strict</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‚Äπ</span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.valid_index|const"><span>valid_index</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>‚üπ</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.Not|const"><span>¬¨</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.index_type|const"><span>index_type</span></a><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><span>‚üπ</span></span><span>
  </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less_eq|const"><span>‚â§</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/HOL.html#HOL.conj|const"><span>‚àß</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="main"><span>(</span></span><span class="free"><span>base</span></span><span class="main"><a class="entity_ref" href="../../HOL/HOL/List.html#List.append|const"><span>@</span></a></span><span class="free"><span>idx</span></span><span class="main"><span>)</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Orderings.html#Orderings.ord_class.less|const"><span>&lt;</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset|const"><span>index_offset</span></a><span> </span><span class="free"><span>T</span></span><span> </span><span class="free"><span>base</span></span><span> </span><span class="main"><a class="entity_ref" href="../../HOL/HOL/Groups.html#Groups.plus_class.plus|const"><span>+</span></a></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.MemObj_Size|const"><span>MemObj_Size</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.index_type|const"><span>index_type</span></a><span> </span><span class="free"><span>base</span></span><span> </span><span class="free"><span>T</span></span><span class="main"><span>)</span></span><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|fact"><span>phantom_mem_semantic_type_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Tools/induct.ML.html#HOL.induct|method"><span class="operator"><span>induct</span></span></a><span> </span><span class="quoted"><span class="free"><span>idx</span></span></span><span> </span><span class="quasi_keyword"><span>arbitrary</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><span class="quoted"><span class="free"><span>base</span></span></span><span> </span><span class="quasi_keyword"><span>rule</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.rev_induct|fact"><span>rev_induct</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>simp</span></span><span> </span><span class="quasi_keyword"><span>del</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span> </span><span class="quasi_keyword"><span>add</span></span><span class="main"><span class="main"><span>:</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/List.html#List.append_assoc|fact"><span>append_assoc</span></a><span class="main"><span class="main"><span>[</span></span></span><span class="operator"><span>symmetric</span></span><span class="main"><span class="main"><span>]</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.fold_tail|fact"><span>fold_tail</span></a><span class="main"><span class="keyword3"><span>;</span></span></span><span>
      </span><span class="operator"><span>insert</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.idx_step_offset_size|fact"><span>idx_step_offset_size</span></a><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.index_offset_upper_bound|fact"><span>index_offset_upper_bound</span></a><span class="main"><span class="keyword3"><span>,</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span class="main"><span>)</span></span><span>

</span><span class="keyword1"><span class="command"><span>lemma</span></span></span><span> </span><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_element|fact"><span class="entity_def" id="PhiSem_Mem_C_Base.phantom_mem_semantic_type_element|thm"><span>phantom_mem_semantic_type_element</span></span></span><span class="main"><span>:</span></span><span>
  </span><span class="quoted"><span class="quoted"><span>‚Äπ </span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.valid_idx_step|const"><span>valid_idx_step</span></a><span> </span><span class="free"><span>TY</span></span><span> </span><span class="free"><span>i</span></span><span>
</span><span class="main"><span>‚üπ</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></a><span> </span><span class="free"><span>TY</span></span><span>
</span><span class="main"><span>‚üπ</span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type|const"><span>phantom_mem_semantic_type</span></a><span> </span><span class="main"><span>(</span></span><a class="entity_ref" href="../Phi_Semantics/PhSm_Ag_Base.html#PhSm_Ag_Base.idx_step_type|const"><span>idx_step_type</span></a><span> </span><span class="free"><span>i</span></span><span> </span><span class="free"><span>TY</span></span><span class="main"><span>)</span></span><span>‚Ä∫</span></span></span><span>
  </span><span class="keyword1"><span class="command"><span>unfolding</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.phantom_mem_semantic_type_def|fact"><span>phantom_mem_semantic_type_def</span></a><span>
  </span><span class="keyword1"><span class="command"><span>using</span></span></span><span> </span><a class="entity_ref" href="Phi_Semantics.PhiSem_Mem_C_Base.html#PhiSem_Mem_C_Base.memobj_size_step|fact"><span>memobj_size_step</span></a><span> </span><span class="keyword1"><span class="command"><span>by</span></span></span><span> </span><a class="entity_ref" href="../../HOL/HOL/ISABELLE_HOME/src/Provers/clasimp.ML.html#HOL.fastforce|method"><span class="operator"><span>fastforce</span></span></a><span>



</span><span class="keyword1"><span class="command"><span>section</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‚ÄπFiction‚Ä∫</span></span></span><span>

</span><span class="keyword1"><span class="command"><span>text</span></span></span><span> </span><span class="quoted"><span class="plain_text"><span>‚ÄπThey are not semantics, but parameters of the inference system.

</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‚Äπ</span></span><span>Map_of_Val‚Ä∫</span></span></span><span> can be defined from </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‚Äπ</span></span><span>valid_idx_step, idx_step_type‚Ä∫</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‚Äπ</span></span><span>idx_step_value‚Ä∫</span></span></span><span>, e.g.,

</span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‚Äπ</span></span><span>primrec Map_of_Val :: ‚ÄπTY ‚áí VAL ‚áí aggregate_path ‚áÄ VAL‚Ä∫
  where ‚ÄπMap_of_Val _  v [] = Some v‚Ä∫
      | ‚ÄπMap_of_Val TY v (i#idx) = (if valid_idx_step TY i
                                    then Map_of_Val (idx_step_type i TY) (idx_step_value i v) idx
                                    else None)‚Ä∫
‚Ä∫</span></span></span><span>

but we do not fix the definition because, </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‚Äπ</span></span><span>idx_step_value‚Ä∫</span></span></span><span> and </span><span class="antiquoted"><span class="raw_text"><span class="operator"><span>‚Äπ</span></span><span>idx_step_type‚Ä∫</span></span></span><span> only determines the
children of a node but not the value of the node. Whether the node is valued, affects whether and
how could the tree be separated. The naive definition above actually disables any separation because
the value bound to the node contains the entire data, so actually meaningless for the purpose of
being a tree enabling separation of aggregate structures.
‚Ä∫</span></span></span><span>

</span><span class="comment1"><span>(*
locale aggregate_mem_resource =
  partial_map_resource Res ‚ÄπŒªblk. discrete ` Byte_Rep_of_Val ` Well_Type (typ_of_blk blk)‚Ä∫
  for Res :: "('blk ‚áí 8 word list discrete option) resource_entry"
  and typ_of_blk :: ‚Äπ'blk ‚áí TY‚Ä∫

locale perm_aggregate_mem_fiction =
  pointwise_base_fiction_for_partial_mapping_resource
      Res ‚ÄπŒªblk. ‚Ñ±_functional (Byte.Rep_of_Val_ins (typ_of_blk blk)) (Byte.Rep_of_Val_ins_dom (typ_of_blk blk)) ‚®æ
                 ‚Ñ±_functional ((‚àò) to_share ‚àò Map_of_Val_ins) (Map_of_Val_ins_dom (typ_of_blk blk))‚Ä∫
      Fic ‚ÄπŒªblk. discrete ` Byte_Rep_of_Val ` Well_Type (typ_of_blk blk)‚Ä∫
  for Res :: "('blk ‚áí 8 word list discrete option) resource_entry"
  and typ_of_blk :: ‚Äπ'blk ‚áí TY‚Ä∫
  and null_blk :: 'blk
  and Fic :: "('blk ‚áí aggregate_path ‚áí VAL discrete share option) fiction_entry"
begin

sublocale aggregate_mem_resource Res typ_of_blk ..

lemma getter_rule:
  ‚Äπ valid_index (typ_of_blk blk) idx
‚üπ ùóâùóãùñæùóÜùóÇùóåùñæ u_idx ‚àà Well_Type (index_type idx (typ_of_blk blk)) ‚àß cblk = blk
‚üπ ùóâùóãùñæùóÜùóÇùóåùñæ 0 &lt; n
‚üπ ùóâùóãùóàùñº R.œÜR_get_res_entry' cblk ‚¶É 1(blk := n ‚¶º (to_share ‚àò idx ‚Ä£<span class="hidden">‚á©</span><sub>m</sub> (map_option discrete ‚àò Map_of_Val u_idx))) ‚¶Ç œÜ Itself ‚üº
      Œªret. 1(blk := n ‚¶º (to_share ‚àò idx ‚Ä£<span class="hidden">‚á©</span><sub>m</sub> (map_option discrete ‚àò Map_of_Val u_idx))) ‚¶Ç œÜ Itself
          ùóåùóéùñªùóÉ x. ret = œÜarg (discrete (Byte_Rep_of_Val x)) ‚àß x ‚àà Well_Type (typ_of_blk blk) ‚àß index_value idx x = u_idx ‚¶Ñ‚Ä∫
  unfolding Premise_def
  subgoal premises prems proof -

  have [simp]: ‚Äπcblk = blk‚Ä∫
    by (simp add: prems(2))

  have simp1: ‚Äπ
      (A x ùóåùóéùñªùóÉ x. B x ‚àß x ‚àà Byte.Rep_of_TY (typ_of_blk blk) ‚àß x ‚àà Byte_Rep_of_Val ` {a. index_value idx a = u_idx ‚àß a ‚àà Well_Type (typ_of_blk cblk)})
    = (A (Byte_Rep_of_Val v) ùóåùóéùñªùóÉ v. B (Byte_Rep_of_Val v) ‚àß v ‚àà Well_Type (typ_of_blk blk) ‚àß index_value idx v = u_idx) ‚Ä∫
  for A B C ret TY S
  unfolding BI_eq_iff split_discrete_ex
  by (auto simp: image_iff Bex_def)

  show ?thesis
    by (rule "_getter_rule_2_"[OF _ Byte.fiction_Map_of_Val_ins_perm_projection_half_BYTE,
              where k=cblk and k'=blk and idx1=idx and u_idx1=u_idx,
              simplified split_discrete_ExBI inj_image_mem_iff inj_discrete simp1],
        insert prems, simp+)
qed .


context notes mul_carrier_option_def[simp] option.pred_True[simp] begin

lemma allocate_rule:
  ‚Äπ ùóâùóãùñæùóÜùóÇùóåùñæ (‚àÄr. finite (dom r) ‚ü∂ (‚àÉblk. blk ‚àâ dom r ‚àß typ_of_blk blk = TY ‚àß blk ‚â† null_blk))
‚üπ ùóâùóãùñæùóÜùóÇùóåùñæ (‚àÄv‚ààU. v ‚àà Well_Type TY)
‚üπ ùóâùóãùóàùñº R.œÜR_allocate_res_entry (Œªblk. typ_of_blk blk = TY ‚àß blk ‚â† null_blk) (Œªk. {Some (discrete (Byte_Rep_of_Val v)) |v. v‚ààU })
      ‚¶É Void ‚üº Œªret. 1(blk := to_share ‚àò (map_option discrete ‚àò Map_of_Val v)) ‚¶Ç œÜ Itself
                  ùóåùóéùñªùóÉ blk v. ret = œÜarg blk ‚àß v ‚àà U ‚àß typ_of_blk blk = TY ‚àß blk ‚â† null_blk  ‚¶Ñ ‚Ä∫
  unfolding Premise_def
  subgoal premises prems proof-

  note pointwise_set_UNIV[simp] ‚Ñ±_functional_condition_Map_of_Val_ins_dom[simp]

  have t1[simp]: ‚Äπv ‚àà U ‚üπ Byte.Val_of_Rep TY (Byte_Rep_of_Val v) = v‚Ä∫ for v
    using prems(2) by auto
  have [simp]:
       ‚Äπ{(1, to_share ‚àò (map_option discrete ‚àò Map_of_Val (Byte.Val_of_Rep TY (Byte_Rep_of_Val v)))) |v. v ‚àà U}
      = {(1, to_share ‚àò (map_option discrete ‚àò Map_of_Val v)) |v. v ‚àà U}‚Ä∫
    by force

  note rule = sep_refinement_stepwise[
        OF refinement_frame[OF Byte.Rep_of_Val_ins.‚Ñ±_functional_refinement'[simplified]]
           sep_refinement_stepwise[
                    OF refinement_frame[OF Map_of_Val_ins.‚Ñ±_functional_refinement'[simplified]]
                       pointwise_to_share.‚Ñ±_functional_refinement'[where B=‚ÄπMap_of_Val_ins ` B‚Ä∫ for B, unfolded defined_set_in_image]
                       pointwise_to_share.‚Ñ±_functional_projection,
                    where B6=‚ÄπByte.Rep_of_Val_ins TY ` B‚Ä∫ for B, unfolded defined_set_in_image],
        where a35=‚ÄπNone‚Ä∫ and B22=‚Äπ{Some (discrete (Byte_Rep_of_Val v)) |v. v ‚àà U}‚Ä∫,
        simplified,
        OF _ _ _ refinement_projections_stepwise_UNIV_paired[
            OF Map_of_Val_ins.‚Ñ±_functional_projection
               pointwise_to_share.‚Ñ±_functional_projection,
            where Dc=‚Äπ{1}‚Ä∫,
            simplified]]

  show ?thesis
    by (rule "__allocate_rule_3__"[
          where U =‚ÄπŒªk. {Some (discrete (Byte_Rep_of_Val v)) |v. v‚ààU }‚Ä∫
            and U'=‚ÄπŒªk. {to_share ‚àò (map_option discrete ‚àò Map_of_Val v) |v. v ‚àà U}‚Ä∫ , simplified],
        unfold ‚Ñ±_functional_comp[where f=‚Äπ(‚àò) to_share‚Ä∫ and Df=‚ÄπUNIV‚Ä∫, simplified, simp]
               one_option_def,
        simp, rule rule,
        simp add: subset_iff, insert Byte.Rep_of_Val_ins_dom_eval(2) prems(2), blast,
        simp add: Byte.‚Ñ±_functional_condition_Rep_of_Val_ins_dom,
        simp add: subset_iff, force,
        simp add: R.in_invariant inj_image_mem_iff, force,
        clarsimp simp add: R.in_invariant Ball_def dom1_dom, metis dom_map_option_comp prems(1))
qed .

lemma setter_rule:
  assumes EQ: ‚ÄπùóâùóãùñæùóÜùóÇùóåùñæ cblk = blk‚Ä∫
  shows ‚Äπ valid_index (typ_of_blk blk) idx
      ‚üπ ùóâùóãùñæùóÜùóÇùóåùñæ v ‚àà Well_Type (index_type idx (typ_of_blk blk))
      ‚üπ ùóâùóãùñæùóÜùóÇùóåùñæ u_idx ‚àà Well_Type (index_type idx (typ_of_blk blk))
      ‚üπ ùóâùóãùñæùóÜùóÇùóåùñæ (‚àÄx‚ààWell_Type (typ_of_blk blk). index_mod_value cidx (Œª_. v) x = index_mod_value idx (Œª_. v) x)
      ‚üπ ùóâùóãùóàùñº R.œÜR_set_res (map_fun_atS cblk (Œªh. {Some (map_discrete (Byte.map_Rep (typ_of_blk cblk) (index_mod_value cidx (Œª_. v))) (the h))}))
            ‚¶É 1(blk := to_share ‚àò idx ‚Ä£<span class="hidden">‚á©</span><sub>m</sub> (map_option discrete ‚àò Map_of_Val u_idx)) ‚¶Ç œÜ Itself ‚üº
              Œªùóãùñæùóç. 1(blk := to_share ‚àò idx ‚Ä£<span class="hidden">‚á©</span><sub>m</sub> (map_option discrete ‚àò Map_of_Val v)) ‚¶Ç œÜ Itself ‚¶Ñ ‚Ä∫
  unfolding Premise_def
  by (simp add: EQ[unfolded Premise_def],
      rule "_setter_rule_2_"[where f=‚ÄπŒªh. {Some (map_discrete (Byte.map_Rep (typ_of_blk blk) (index_mod_value cidx (Œª_. v))) h)}‚Ä∫
                        and V=‚Äπdiscrete ` Byte_Rep_of_Val ` {a. index_value idx a = u_idx ‚àß a ‚àà Well_Type (typ_of_blk blk)}‚Ä∫
                        and F=‚ÄπŒª_. {to_share o idx ‚Ä£<span class="hidden">‚á©</span><sub>m</sub> (map_option discrete ‚àò Map_of_Val v)}‚Ä∫
                        for idx cidx v u_idx,
                      simplified,
                      OF _ Byte.fiction_Map_of_Val_perm_partial_refinement_BYTE[simplified]
                           Byte.fiction_Map_of_Val_ins_perm_projection_BYTE[simplified]],
      simp,
      assumption,
      assumption,
      assumption,
      assumption,
      assumption,
      assumption,
      clarsimp simp add: split_discrete_meta_all inj_image_mem_iff index_mod_value_welltyp image_iff Bex_def,
      metis Byte.Val_of_Rep_inj index_mod_value_welltyp Byte.map_Rep_def)

lemma deallocate_rule:
  ‚Äπ ùóâùóãùñæùóÜùóÇùóåùñæ v ‚àà Well_Type (typ_of_blk blk)
‚üπ ùóâùóãùóàùñº R.œÜR_set_res (map_fun_atS blk (Œª_. {None}))
      ‚¶É 1(blk := to_share ‚àò (map_option discrete ‚àò Map_of_Val v)) ‚¶Ç œÜ Itself ‚üº
        Œªùóãùñæùóç. 1 ‚¶Ç œÜ Itself ‚¶Ñ ‚Ä∫
  unfolding Premise_def
subgoal premises prems
proof -
  have [simp]:
    ‚ÄπMap.empty ‚àò the = Map.empty‚Ä∫
    unfolding fun_eq_iff by simp

  note inj_image_mem_iff[simp] pointwise_set_UNIV[simp] ‚Ñ±_functional_condition_Map_of_Val_ins_dom[simp]
       ‚Ñ±_functional_comp[where f=‚Äπ(‚àò) to_share‚Ä∫ and Df=‚ÄπUNIV‚Ä∫, simplified, symmetric, simp]

  have [simp]: ‚ÄπByte.Val_of_Rep (typ_of_blk blk) (Byte_Rep_of_Val v) = v‚Ä∫
    by (simp add: prems)

  note rule1 = refinement_projections_stepwise_UNIV_paired[
          OF Map_of_Val_ins.‚Ñ±_functional_projection
             pointwise_to_share.‚Ñ±_functional_projection,
          where Dc=‚Äπ{Some (discrete v)}‚Ä∫,
          simplified]

  show ?thesis
apply simp
apply (rule "_setter_rule_2_"[where f=‚ÄπŒª_. {None}‚Ä∫ and V=‚Äπ{discrete v}‚Ä∫ and F=‚ÄπŒª_. 1‚Ä∫ for v, simplified])
apply (simp,
        unfold refinement_source_subjection, rule impI,
        rule sep_refinement_stepwise [
            OF refinement_frame[OF Byte.Rep_of_Val_ins.‚Ñ±_functional_refinement[simplified]]
               sep_refinement_stepwise[
                        OF refinement_frame[OF Map_of_Val_ins.‚Ñ±_functional_refinement[simplified]]
                           pointwise_to_share.‚Ñ±_functional_refinement
                           pointwise_to_share.‚Ñ±_functional_projection],
            where a16=‚ÄπSome (discrete (Byte_Rep_of_Val v))‚Ä∫ and b16=None and TY16=‚Äπtyp_of_blk blk‚Ä∫,
            simplified])
    apply blast
    using Byte.‚Ñ±_functional_condition_Rep_of_Val_ins_dom apply presburger
    using prems apply blast
    apply (rule rule1)
    using prems apply blast
    apply (rule refinement_projections_stepwise_UNIV_paired)
    prefer 2
    apply (rule rule1)
    apply (simp add: prems)
    apply (rule Byte.Rep_of_Val_ins.‚Ñ±_functional_projection
      [where S=‚Äπ{Some (discrete (Byte_Rep_of_Val v))}‚Ä∫ and TY=‚Äπtyp_of_blk blk‚Ä∫, simplified])
    using prems by blast
qed .

end

end
*)</span></span><span>

</span><span class="keyword2"><span class="keyword"><span>end</span></span></span></pre>
</body>

</html>